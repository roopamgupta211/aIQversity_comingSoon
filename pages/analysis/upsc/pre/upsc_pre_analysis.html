<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WCW8M9JPEZ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-WCW8M9JPEZ');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="UPSC CSE 2025 Prelims Analysis - Comprehensive question-wise breakdown with AI-powered insights">
    <title>UPSC CSE 2025 Analysis - aIQversity</title>
    <link rel="icon" href="../../../../images/favicon.ico" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 5rem; /* Account for fixed header when scrolling to anchors */
        }
        body {
            padding-top: 5rem;
            margin-top: 0 !important;
            position: relative;
            z-index: 1;
        }
        nav.bg-white.shadow-lg.fixed.w-full.z-50 {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            z-index: 9999 !important;
            background-color: #ffffff !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
            border-bottom: 1px solid #e5e7eb;
        }
        /* Ensure navigation content is properly positioned */
        nav .max-w-7xl {
            position: relative;
            z-index: 10000;
        }
        /* Mobile Responsiveness Improvements */
        @media (max-width: 768px) {
            
            /* Questions container additional top spacing */
            .py-16.bg-gray-50 {
                padding-top: 2rem;
            }
            
            /* Hero section spacing */
            .pt-24.pb-8 {
                padding-top: 1.5rem !important;
            }
           
            /* Question Cards Mobile */
            .question-card {
                margin: 0 -1rem;
                border-radius: 0.75rem;
                padding: 1rem;
            }
            
            /* Question Header Stack on Mobile */
            .question-card .flex.justify-between {
                flex-direction: column;
                gap: 0.75rem;
                align-items: flex-start;
            }
            
            /* Badge Container Stack */
            .question-card .flex.items-center.space-x-3 {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            /* Options Single Column on Mobile */
            .question-card .grid.md\\:grid-cols-2 {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
            
            /* Analysis Content Mobile */
            .dropdown-content .grid.md\\:grid-cols-2 {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            /* Step and Tip Items */
            .step-item, .tip-item {
                padding: 0.75rem;
                font-size: 0.875rem;
                line-height: 1.4;
            }
            
            /* Charts on Mobile */
            .bg-white.rounded-xl.shadow-lg.p-6 {
                padding: 1rem;
            }
            
            /* Analysis Cards Mobile */
            .analysis-card {
                padding: 1rem;
                margin: 0 -0.5rem;
            }
            
            /* Pagination Mobile */
            #pagination {
                justify-content: center;
                flex-wrap: wrap;
                gap: 0.25rem;
            }
            
            #pagination button {
                padding: 0.5rem 0.75rem;
                font-size: 0.875rem;
                min-width: 2.5rem;
            }
            
            /* Search and Filters Mobile */
            .mb-8.flex.flex-wrap.gap-4.justify-center {
                flex-direction: column;
                gap: 0.75rem;
            }
            
            .mb-8.flex.flex-wrap.gap-4.justify-center input,
            .mb-8.flex.flex-wrap.gap-4.justify-center select {
                width: 100%;
                margin: 0;
            }
            
            /* Text Sizing for Mobile */
            .question-card p {
                font-size: 0.9rem;
                line-height: 1.5;
            }
            
            .question-card h4 {
                font-size: 1.1rem;
            }
            
            /* Improve Touch Targets */
            .question-card button {
                padding: 0.75rem 1rem;
                min-height: 44px;
                font-size: 0.9rem;
            }
            
            /* Container Margins */
            .max-w-7xl.mx-auto.px-4 {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            /* Navigation Mobile Fixes */
            nav .flex.justify-between.items-center.h-20 {
                height: 4rem; /* Reduce height on mobile */
            }

            nav .flex.items-center.logo-shine.w-1\\/4 {
                width: auto;
                min-width: 40px;
            }

            nav .flex.items-center.logo-shine.w-1\\/4 img {
                height: 3rem; /* Smaller logo on mobile */
                max-width: 40px;
            }

            nav .flex-1.flex.justify-center span {
                font-size: 1.25rem; /* Smaller brand name */
            }

            nav .flex.items-center.space-x-4.w-1\\/4 {
                width: auto;
                flex: 1;
                justify-content: flex-end;
                space-x: 0.5rem;
            }

            /* Navigation Links Mobile */
            nav .flex.items-center.space-x-4.w-1\\/4 a:first-child {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
            }

            nav .flex.items-center.space-x-4.w-1\\/4 a:last-child {
                padding: 0.5rem 0.75rem;
                font-size: 0.75rem;
                min-width: auto;
            }

        }

        /* Extra Small Screens */
        @media (max-width: 480px) {
            nav .max-w-7xl.mx-auto.px-4 {
                padding-left: 0.75rem;
                padding-right: 0.75rem;
            }
            
            nav .flex-1.flex.justify-center span {
                font-size: 1.1rem;
            }
            
            nav .flex.items-center.space-x-4.w-1\\/4 {
                gap: 0.25rem;
            }
            
            nav .flex.items-center.space-x-4.w-1\\/4 a {
                padding: 0.5rem 0.5rem;
                font-size: 0.7rem;
                min-height: 2.5rem;
                display: flex;
                align-items: center;
            }
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        .float-animation {
            animation: float 6s ease-in-out infinite;
        }
        .gradient-text {
            background: linear-gradient(45deg, #F7A621, #45E6C0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text
        }
        .logo-shine {
            position: relative;
            overflow: hidden;
        }
        .logo-shine::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to right,
                rgba(255, 255, 255, 0) 0%,
                rgba(255, 255, 255, 0.3) 50%,
                rgba(255, 255, 255, 0) 100%
            );
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }
        .hero-pattern {
            background-color: #ffffff;
            background-image: radial-gradient(#101E3D 0.5px, transparent 0.5px), radial-gradient(#101E3D 0.5px, #ffffff 0.5px);
            background-size: 20px 20px;
            background-position: 0 0,10px 10px;
            opacity: 0.1;
        }
        .question-card {
            transition: all 0.3s ease;
            border-left: 4px solid #F7A621;
        }
        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(16, 30, 61, 0.1);
        }
        .difficulty-easy { border-left-color: #10B981; }
        .difficulty-medium { border-left-color: #F7A621; }
        .difficulty-hard { border-left-color: #EF4444; }
        .analysis-card {
            background: linear-gradient(135deg, rgba(16, 30, 61, 0.02) 0%, rgba(69, 230, 192, 0.02) 100%);
            border: 1px solid rgba(16, 30, 61, 0.1);
        }
        .stats-card {
            background: linear-gradient(135deg, #F7A621 0%, #FFD166 100%);
        }
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #F7A621;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .option-letter {
            background: #101E3D;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }
        .correct-option {
            background: #10B981 !important;
        }
        .dropdown-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .dropdown-content.expanded {
            max-height: 2000px;
            overflow-y: auto;
            transition: max-height 0.5s ease-in;
        }
        .step-item {
            background: rgba(69, 230, 192, 0.1);
            border-left: 3px solid #45E6C0;
        }
        .tip-item {
            background: rgba(247, 166, 33, 0.1);
            border-left: 3px solid #F7A621;
        }
        .difficulty-badge-easy { background: rgba(16, 185, 129, 0.1); color: #10B981; }
        .difficulty-badge-medium { background: rgba(247, 166, 33, 0.1); color: #F7A621; }
        .difficulty-badge-hard { background: rgba(239, 68, 68, 0.1); color: #EF4444; }

        /* Mobile Navigation Improvements */
        @media (max-width: 640px) {
            /* Adjust logo area for mobile home button */
            nav .flex.items-center.logo-shine.w-1\\/4 {
                width: auto;
                min-width: fit-content;
            }
            
            /* Center brand name better on mobile */
            nav .flex-1.flex.justify-center {
                margin-left: 0;
                margin-right: 0;
            }
            
            /* Adjust right section */
            nav .flex.items-center.space-x-4.w-1\\/4.justify-end {
                width: auto;
                flex: 1;
                justify-content: flex-end;
            }
            
            /* Style mobile home button */
            nav .sm\\:hidden.flex.items-center {
                padding: 0.5rem 0.75rem;
                background: rgba(247, 166, 33, 0.1);
                border-radius: 0.375rem;
                font-weight: 500;
                color: #F7A621;
            }
            
            nav .sm\\:hidden.flex.items-center:hover {
                background: rgba(247, 166, 33, 0.2);
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation - Exact match with index.html -->
    <nav class="bg-white shadow-lg fixed w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center logo-shine w-1/4">
                <!-- Logo - hidden on mobile -->
                <img src="../../../../images/TTD_Logo.png" alt="TetraTech Logo" class="hidden sm:block h-20 w-auto transform hover:scale-105 transition-transform duration-300" style="max-width: 60px; object-fit: contain;"/>
                <!-- Home button - visible only on mobile -->
                <a href="../../../../index.html" class="sm:hidden flex items-center text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium">
                    <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m0 0v14"/>
                    </svg>
                    Home
                </a>
            </div>
                <div class="flex-1 flex justify-center">
                    <span class="text-2xl font-bold" style="color: #101E3D">a<span style="color: #F7A621">IQ</span>versity</span>
                </div>
                <div class="flex items-center space-x-4 w-1/4 justify-end">
                    <a href="../../../../index.html" class="hidden sm:inline-flex text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium">‚Üê Back to Home</a>
                    <a href="/register" class="bg-blue-600 text-white px-6 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transform hover:scale-105 transition-all duration-300 shadow-lg">Join Waitlist</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="pt-24 pb-8 md:pt-32">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl sm:text-5xl font-bold mb-4" style="color: #101E3D;">
                UPSC CSE 2025 <span class="gradient-text">Prelims Analysis</span>
            </h1>
            <p class="text-xl text-gray-600 mb-8 max-w-3xl mx-auto">
                Comprehensive AI-powered analysis of General Studies Paper with question-wise breakdowns, difficulty assessments, and strategic insights
            </p>
            <div class="inline-flex items-center px-6 py-3 rounded-lg" style="background: rgba(247, 166, 33, 0.2); border: 1px solid #F7A621;">
                <svg class="w-5 h-5 mr-2" style="color: #F7A621;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <span style="color: #F7A621;" class="font-medium">This is a preview of our upcoming AI analysis feature</span>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div id="loadingState" class="flex justify-center items-center py-16">
        <div class="text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-gray-600">Loading analysis data...</p>
        </div>
    </div>

    <!-- Main Content -->
    <div id="mainContent" class="hidden">
        <!-- Overall Analysis Section -->
        <div class="py-16 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold mb-4" style="color: #101E3D;">Paper Overview & Comparative Analysis</h2>
                    <p class="text-xl text-gray-600 max-w-4xl mx-auto">
                        A comprehensive breakdown of UPSC CSE 2025 Prelims GS Paper compared to previous years' patterns and trends
                    </p>
                </div>

                <!-- Analysis Cards Row 1 -->
                <div class="grid md:grid-cols-2 gap-8 mb-8">
                    <div class="analysis-card rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4" style="color: #101E3D;">Year-on-Year Highlights</h3>
                        <div class="space-y-3 text-sm">
                            <div class="flex justify-between">
                                <span><strong>Subject Balance:</strong></span>
                                <span class="text-green-600">More uniform</span>
                            </div>
                            <div class="flex justify-between">
                                <span><strong>Difficulty Level:</strong></span>
                                <span class="text-orange-600">Moderate-Difficult</span>
                            </div>
                            <div class="flex justify-between">
                                <span><strong>Current Affairs:</strong></span>
                                <span class="text-blue-600">38% (5-year high)</span>
                            </div>
                            <div class="flex justify-between">
                                <span><strong>Question Type:</strong></span>
                                <span class="text-purple-600">Application-based</span>
                            </div>
                        </div>
                    </div>

                    <div class="analysis-card rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4" style="color: #101E3D;">Key Observations</h3>
                        <div class="space-y-3 text-sm">
                            <div class="flex justify-between">
                                <span><strong>Static vs Dynamic:</strong></span>
                                <span>62% : 38%</span>
                            </div>
                            <div class="flex justify-between">
                                <span><strong>Technology Focus:</strong></span>
                                <span class="text-green-600">15% (highest since 2019)</span>
                            </div>
                            <div class="flex justify-between">
                                <span><strong>Environment Surge:</strong></span>
                                <span class="text-blue-600">13% questions</span>
                            </div>
                            <div class="flex justify-between">
                                <span><strong>Statement Format:</strong></span>
                                <span class="text-orange-600">45% analytical</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cutoff Prediction Section -->
                <div class="mb-8">
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
                        <h3 class="text-xl font-bold mb-4 flex items-center" style="color: #101E3D;">
                            <svg class="w-6 h-6 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                            </svg>
                            2025 Cutoff Prediction
                        </h3>
                        <div class="grid md:grid-cols-3 gap-6">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-blue-600 mb-1">86-88</div>
                                <div class="text-sm text-gray-600">Conservative Estimate</div>
                                <div class="text-xs text-gray-500 mt-1">Based on medium difficulty</div>
                            </div>
                            <div class="text-center">
                                <div class="text-3xl font-bold text-green-600 mb-1">88-91</div>
                                <div class="text-sm text-gray-600">Most Likely Range</div>
                                <div class="text-xs text-gray-500 mt-1">Considering current trends</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-orange-600 mb-1">91-93</div>
                                <div class="text-sm text-gray-600">Optimistic Scenario</div>
                                <div class="text-xs text-gray-500 mt-1">If normalization occurs</div>
                            </div>
                        </div>
                        <div class="mt-4 text-xs text-center text-gray-600">
                            *Based on 5-year trend analysis and paper difficulty assessment
                        </div>
                    </div>
                </div>

                <!-- 5-Year Trend Analysis - Compact -->
                <div class="mb-8">
                    <h3 class="text-xl font-bold mb-4" style="color: #101E3D;">5-Year Trend Analysis</h3>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-white rounded-lg p-4 shadow border-l-4" style="border-left-color: #FF6B6B;">
                            <h4 class="font-semibold mb-2" style="color: #101E3D;">Subject Evolution</h4>
                            <div class="text-xs space-y-1">
                                <p>2020-21: History dominant (20-25%)</p>
                                <p>2022-23: Geography surge (18%)</p>
                                <p class="text-green-600 font-medium">2024-25: Balanced distribution</p>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow border-l-4" style="border-left-color: #4ECDC4;">
                            <h4 class="font-semibold mb-2" style="color: #101E3D;">Cutoff History</h4>
                            <div class="text-xs space-y-1">
                                <p>2020: 92.51 (Tough)</p>
                                <p>2023: 75.41 (Very Difficult)</p>
                                <p class="text-blue-600 font-medium">2024: 87.98 (Normalized)</p>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg p-4 shadow border-l-4" style="border-left-color: #45B7D1;">
                            <h4 class="font-semibold mb-2" style="color: #101E3D;">Question Pattern</h4>
                            <div class="text-xs space-y-1">
                                <p>2020-21: Factual recall heavy</p>
                                <p>2022-23: Mixed approach</p>
                                <p class="text-purple-600 font-medium">2024-25: Application-based</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Strategic Insights - Compact -->
                <div class="mb-8">
                    <h3 class="text-xl font-bold mb-4" style="color: #101E3D;">Strategic Insights</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4">
                            <h4 class="font-semibold mb-3" style="color: #101E3D;">What's Working</h4>
                            <ul class="space-y-1 text-sm text-gray-700">
                                <li>‚úÖ Conceptual depth over breadth</li>
                                <li>‚úÖ Current affairs linked to static</li>
                                <li>‚úÖ NCERT foundation (60% questions)</li>
                                <li>‚úÖ Critical thinking emphasis</li>
                            </ul>
                        </div>
                        <div class="bg-gradient-to-r from-amber-50 to-orange-50 rounded-lg p-4">
                            <h4 class="font-semibold mb-3" style="color: #101E3D;">Preparation Shifts</h4>
                            <ul class="space-y-1 text-sm text-gray-700">
                                <li>üîÑ Less factual recall (35%)</li>
                                <li>üîÑ More statement analysis (45%)</li>
                                <li>üîÑ Tech integration rising</li>
                                <li>üîÑ Global current affairs crucial</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Model Selection Tabs -->
                <!-- <div class="py-8 bg-gray-100">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                        <h2 class="text-2xl font-semibold mb-4" style="color: #101E3D;">Select Analysis Model</h2>
                        <div id="modelTabs" class="flex flex-wrap justify-center gap-2">
                        </div>
                    </div>
                </div> -->

                <!-- Charts Section -->
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-lg font-bold mb-4" style="color: #101E3D;">Difficulty Distribution</h3>
                        <canvas id="difficultyChart" width="400" height="300"></canvas>
                    </div>
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-lg font-bold mb-4" style="color: #101E3D;">Cognitive Level Analysis</h3>
                        <canvas id="cognitiveChart" width="400" height="300"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Questions Section -->
        <div class="py-16 bg-gray-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 id="questions-section" class="text-3xl font-bold mb-4" style="color: #101E3D;">Question-wise Analysis</h2>
                    <p class="text-xl text-gray-600">Click on any question to view detailed analysis, solutions, and strategic tips</p>
                </div>

                <!-- Search and Filter -->
                <div class="mb-8 space-y-4 md:space-y-0 md:flex md:flex-wrap md:gap-4 md:justify-center">
                    <input type="text" id="questionSearch" placeholder="Search questions..." class="w-full md:w-auto px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    <select id="difficultyFilter" class="w-full md:w-auto px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Difficulties</option>
                        <option value="Easy">Easy</option>
                        <option value="Medium">Medium</option>
                        <option value="Hard">Hard</option>
                    </select>
                    <select id="subjectFilter" class="w-full md:w-auto px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Subjects</option>
                    </select>
                </div>

                <!-- Questions Container -->
                <div id="questionsContainer" class="space-y-6">
                    <!-- Questions will be dynamically loaded here -->
                </div>

                <!-- Pagination -->
                <div class="mt-12 flex justify-center">
                    <div id="pagination" class="flex space-x-2">
                        <!-- Pagination buttons will be generated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer - Exact match with index.html -->
    <footer class="bg-gray-800">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col items-start">
                <p class="text-gray-400 text-sm mb-2 flex items-center">
                    <!-- 3D Cube/Box Being Assembled icon -->
                    <svg class="w-5 h-5 mr-1 inline" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" fill="none" stroke="currentColor">
                        <path d="M32 2a6 6 0 0 1 6 6v2.1a14.9 14.9 0 0 1 4.3 1.8l1.5-1.5a6 6 0 0 1 8.5 8.5l-1.5 1.5a14.9 14.9 0 0 1 1.8 4.3H56a6 6 0 0 1 0 12h-2.1a14.9 14.9 0 0 1-1.8 4.3l1.5 1.5a6 6 0 0 1-8.5 8.5l-1.5-1.5a14.9 14.9 0 0 1-4.3 1.8V56a6 6 0 0 1-12 0v-2.1a14.9 14.9 0 0 1-4.3-1.8l-1.5 1.5a6 6 0 0 1-8.5-8.5l1.5-1.5a14.9 14.9 0 0 1-1.8-4.3H8a6 6 0 0 1 0-12h2.1a14.9 14.9 0 0 1 1.8-4.3l-1.5-1.5a6 6 0 0 1 8.5-8.5l1.5 1.5a14.9 14.9 0 0 1 4.3-1.8V8a6 6 0 0 1 6-6z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
                        <path d="M32 20a12 12 0 1 0 0 24 12 12 0 0 0 0-24z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
                    </svg>                      
                    with 
                    <!-- Shield with Heart icon -->
                    <svg class="w-5 h-5 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 21a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3a12 12 0 0 0 8.5 3a12.01 12.01 0 0 1 .378 5" />
                        <path d="M18 22l3.35 -3.284a2.143 2.143 0 0 0 .005 -3.071a2.242 2.242 0 0 0 -3.129 -.006l-.224 .22l-.223 -.22a2.242 2.242 0 0 0 -3.128 -.006a2.143 2.143 0 0 0 -.006 3.071l3.355 3.296z" />
                    </svg>                      
                    in Bangalore by
                    <img src="../../../../images/TTD_logo_footer.png" alt="Tetratech Dynamics" class="h-5 ml-1 inline" style="max-height: 20px; object-fit: contain;"/>
                </p>
                <p class="text-gray-400 text-sm mb-2 flex items-center">
                    <svg class="w-5 h-5 mr-1 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    Curious about what we're building? Reach out at contact@aiqversity.com
                </p>
                <p class="text-base text-gray-400">
                    ¬© 2025 aIQversity. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <button id="scrollToTop" class="fixed bottom-4 right-4 bg-blue-600 text-white p-2 rounded-full shadow-lg hidden hover:bg-blue-700 focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
        </svg>
    </button>
    <script>
        // Scroll to top functionality
        const scrollToTopButton = document.getElementById('scrollToTop');
        
        window.onscroll = function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                scrollToTopButton.classList.remove('hidden');
            } else {
                scrollToTopButton.classList.add('hidden');
            }
        };
        
        scrollToTopButton.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        function showFeatures(userType) {
            // Hide all feature sections
            document.querySelectorAll('[id$="Features"]').forEach(el => el.classList.add('hidden'));
            // Show selected section
            document.getElementById(userType + 'Features').classList.remove('hidden');
            
            // Update button styles
            document.querySelectorAll('[onclick^="showFeatures"]').forEach(btn => {
                btn.style.background = '#E5E7EB';
                btn.style.color = '#374151';
            });
            event.target.style.background = '#101E3D';
            event.target.style.color = 'white';
        }

        function scrollFeatures(direction) {
            const container = document.getElementById('featuresContainer');
            const scrollAmount = 400;
            if (direction === 'left') {
                container.scrollLeft -= scrollAmount;
            } else {
                container.scrollLeft += scrollAmount;
            }
        }

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>

    <!-- Registration Modal -->
    <div id="registrationModal" class="fixed inset-0 flex items-center justify-center z-50 hidden px-4 py-6 sm:p-0">
        <div class="absolute inset-0 bg-black opacity-50" id="modalOverlay"></div>
        <div class="bg-white rounded-xl p-8 max-w-md w-full z-10 relative mx-auto my-8 shadow-2xl sm:max-w-lg md:max-w-xl" style="max-height: 90vh; overflow-y: auto;">
            <button class="absolute top-4 right-4 text-gray-500 hover:text-gray-700" id="closeModal">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold" style="color: #101E3D">Join aIQversity Waitlist</h3>
                <p class="text-gray-600 mt-2">Be among the first to experience AI-powered academic excellence</p>
            </div>
            
            <!-- Registration Success Message (Hidden by default) -->
            <div id="registrationSuccess" class="hidden">
                <div class="text-center py-6 px-2">
                    <div class="w-20 h-20 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-6">
                        <svg class="w-10 h-10 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </div>
                    <h4 class="text-2xl font-semibold mb-3" style="color: #101E3D">Thank You for Joining!</h4>
                    <p class="text-gray-600 mb-4 mx-auto max-w-sm">We're thrilled to have you on our waitlist! As one of our early supporters, you'll receive exclusive early bird offers when we launch.</p>
                    <button class="mt-4 px-8 py-3 rounded-lg text-white shadow-md transition-all duration-300 hover:shadow-lg hover:scale-105" style="background-color: #F7A621" id="closeSuccessBtn">
                        Got it!
                    </button>
                </div>
            </div>
            
            <!-- Registration Form -->
            <form id="registrationForm" class="px-1 sm:px-4 py-2" method="PO" onsubmit="submitForm(event)">
                <div class="mb-5">
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                    <input type="text" id="name" name="name" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm">
                </div>
                
                <div class="mb-5">
                    <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                    <input type="email" id="email" name="email" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm">
                </div>
                
                <div class="mb-5">
                    <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">Phone Number (Optional)</label>
                    <input type="tel" id="phone" name="phone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm">
                </div>
                
                <div class="mb-5">
                    <label for="userType" class="block text-sm font-medium text-gray-700 mb-2">I am a</label>
                    <select id="userType" name="user_type" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm">
                        <option value="">Please select</option>
                        <option value="student">Student</option>
                        <option value="teacher">Teacher</option>
                        <option value="parent">Parent</option>
                        <option value="organization">Educational Organization</option>
                    </select>
                </div>
                
                <div class="mb-7">
                    <label class="flex items-start">
                        <input type="checkbox" id="consent" name="consent" required class="mt-1 mr-3 h-4 w-4">
                        <span class="text-sm text-gray-600">I agree to receive updates about aIQversity products and services</span>
                    </label>
                </div>
                
                <button type="submit" class="w-full px-6 py-3 text-white rounded-lg shadow-md transition-all duration-300 hover:scale-105 hover:shadow-lg" style="background-color: #F7A621">
                    Join Waitlist
                </button>
            </form>
        </div>
    </div>

    <script>
        function submitForm(event) {
            event.preventDefault();
            
            // Get form data
            const form = document.getElementById('registrationForm');
            const formData = new FormData(form);
            
            // Convert FormData to URL params
            const data = new URLSearchParams();
            for (const pair of formData) {
                data.append(pair[0], pair[1]);
            }
            
            // Your Google Apps Script web app URL from step 3
            const scriptURL = 'https://script.google.com/macros/s/AKfycbzddb27FVgEJ61ZoGJr6ZV8bk76KR4bY3YDqXLP8v-p2LLy6ptkScfUewwjBQPk_Yo1XA/exec'; // Replace this with your actual web app URL
            
            // Show loading state
            document.querySelector('button[type="submit"]').textContent = 'Submitting...';
            
            // Send data to Google Apps Script
            fetch(scriptURL, {
                method: 'POST',
                body: data
            })
            .then(response => response.json())
            .then(data => {
                // Show success message
                form.style.display = 'none';
                document.getElementById('registrationSuccess').classList.remove('hidden');
            })
            .catch(error => {
                console.error('Error!', error.message);
                alert('Something went wrong. Please try again later.');
            })
            .finally(() => {
                // Reset button text
                document.querySelector('button[type="submit"]').textContent = 'Join Waitlist';
            });
        }
        
        // Registration Modal Functionality
        const registrationButtons = document.querySelectorAll('a[href="/register"]');
        const registrationModal = document.getElementById('registrationModal');
        const modalOverlay = document.getElementById('modalOverlay');
        const closeModalBtn = document.getElementById('closeModal');
        const registrationForm = document.getElementById('registrationForm');
        const registrationSuccess = document.getElementById('registrationSuccess');
        const closeSuccessBtn = document.getElementById('closeSuccessBtn');
        
        // Open modal when registration buttons are clicked
        registrationButtons.forEach(button => {
            button.addEventListener('click', function(e) {
                e.preventDefault();
                registrationModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // Prevent scrolling
            });
        });
        
        // Close modal functionality
        function closeModal() {
            registrationModal.classList.add('hidden');
            document.body.style.overflow = 'auto'; // Enable scrolling
            registrationForm.reset();
            registrationForm.style.display = 'block';
            registrationSuccess.classList.add('hidden');
        }
        
        closeModalBtn.addEventListener('click', closeModal);
        modalOverlay.addEventListener('click', closeModal);
        closeSuccessBtn.addEventListener('click', closeModal);
    </script>

    <script>
        // Global variables
        let questionsData = [];
        let currentPage = 1;
        const questionsPerPage = 10;
        let filteredQuestions = [];
        let charts = {};

        // New variables for tabbed models
        const modelFiles = {
            'GPT-4.1': 'UPSC_PRE_GS_2025_analysis_GPT4dot1.json', // Your original file
            'GPT-4.1 Mini': 'UPSC_PRE_GS_2025_analysis_GPT4dot1_mini.json',
            'GPT-4.1 Nano': 'UPSC_PRE_GS_2025_analysis_GPT4dot1_nano.json'
        };
        let currentJsonFile = modelFiles['GPT-4.1']; // Default file to load

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Page loaded, initializing tabs and loading default data...');
            initializeTabs();
            loadData(currentJsonFile);
        });

        // JSON data will be embedded here - replace this with your actual JSON array
        function initializeTabs() {
            const tabContainer = document.getElementById('modelTabs');
            if (!tabContainer) {
                console.error('Tab container #modelTabs not found.');
                return;
            }
            tabContainer.innerHTML = ''; // Clear any existing buttons

            Object.keys(modelFiles).forEach(modelName => {
                const button = document.createElement('button');
                button.textContent = modelName;
                button.dataset.file = modelFiles[modelName];
                button.className = 'px-4 py-2 rounded-lg text-sm font-medium mr-2 mb-2 transition-colors duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500';
                
                if (modelFiles[modelName] === currentJsonFile) {
                    button.classList.add('bg-blue-600', 'text-white', 'shadow-md');
                } else {
                    button.classList.add('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
                }

                button.addEventListener('click', function() {
                    // Update active tab style
                    tabContainer.querySelectorAll('button').forEach(btn => {
                        btn.classList.remove('bg-blue-600', 'text-white', 'shadow-md');
                        btn.classList.add('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');
                    });
                    this.classList.add('bg-blue-600', 'text-white', 'shadow-md');
                    this.classList.remove('bg-gray-200', 'text-gray-700', 'hover:bg-gray-300');

                    const newFile = this.dataset.file;
                    if (newFile !== currentJsonFile) {
                        currentJsonFile = newFile;
                        // Show loading state and hide content before loading new data
                        document.getElementById('loadingState').classList.remove('hidden');
                        document.getElementById('mainContent').classList.add('hidden');
                        document.getElementById('loadingState').innerHTML = `
                            <div class="text-center">
                                <div class="loading-spinner mx-auto mb-4"></div>
                                <p class="text-gray-600">Loading analysis data for ${modelName}...</p>
                            </div>`;
                        loadData(currentJsonFile);
                    }
                });
                tabContainer.appendChild(button);
            });
        }
        
        // Function to load JSON data
        async function loadData(fileName) {
            try {
                console.log(`Attempting to fetch JSON file: ./${fileName}...`);
                
                // Ensure loading state is visible and main content hidden
                const loadingStateDiv = document.getElementById('loadingState');
                const mainContentDiv = document.getElementById('mainContent');
                loadingStateDiv.classList.remove('hidden');
                mainContentDiv.classList.add('hidden');
                // Update loading message if not already set by tab click
                if (!loadingStateDiv.querySelector('.loading-spinner')) {
                     loadingStateDiv.innerHTML = `
                        <div class="text-center">
                            <div class="loading-spinner mx-auto mb-4"></div>
                            <p class="text-gray-600">Loading analysis data...</p>
                        </div>`;
                }

                // Clear previous data and UI elements that depend on data
                questionsData = [];
                filteredQuestions = [];
                currentPage = 1;

                if (charts.difficulty) { charts.difficulty.destroy(); delete charts.difficulty; }
                if (charts.cognitive) { charts.cognitive.destroy(); delete charts.cognitive; }
                
                const questionsContainer = document.getElementById('questionsContainer');
                if (questionsContainer) questionsContainer.innerHTML = '';
                const paginationContainer = document.getElementById('pagination');
                if (paginationContainer) paginationContainer.innerHTML = '';
                
                // Reset filters to default state before populating
                const questionSearchInput = document.getElementById('questionSearch');
                if (questionSearchInput) questionSearchInput.value = '';
                
                const subjectFilterSelect = document.getElementById('subjectFilter');
                if (subjectFilterSelect) subjectFilterSelect.innerHTML = '<option value="">All Subjects</option>';
                
                const difficultyFilterSelect = document.getElementById('difficultyFilter');
                if (difficultyFilterSelect) difficultyFilterSelect.innerHTML = '<option value="">All Difficulties</option>';

                const response = await fetch(`./${fileName}`);

                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error(`JSON file not found at ./${fileName}. Status: ${response.status}`);
                    }
                    throw new Error(`HTTP error! status: ${response.status} for file ${fileName}`);
                }

                const data = await response.json();
                console.log(`JSON ${fileName} loaded successfully:`, data.length, 'questions');
                questionsData = Array.isArray(data) ? data : [data];

                if (questionsData.length === 0) {
                    throw new Error(`JSON data in ${fileName} is empty or not in the expected array format.`);
                }

                filteredQuestions = [...questionsData];

                setupCharts();
                populateFilters();
                renderQuestions();
                setupPagination();
                updateStatistics(); // This function was in your original code.
                                     // Ensure elements it targets (e.g., #doableQuestions, #avgDifficulty) exist,
                                     // or comment this out if they are not used.
                                     // The provided HTML does not contain these elements.

                loadingStateDiv.classList.add('hidden');
                mainContentDiv.classList.remove('hidden');

            } catch (error) {
                console.error(`Error loading data from ${fileName}:`, error);
                const loadingStateDiv = document.getElementById('loadingState');
                loadingStateDiv.innerHTML =
                    `<div class="text-center max-w-2xl mx-auto py-10">
                        <div class="text-red-600 mb-6">
                            <svg class="w-12 h-12 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <p class="text-lg font-semibold mb-2">Error Loading Analysis Data for ${fileName}</p>
                            <div class="text-sm text-left bg-red-50 p-4 rounded-lg shadow">
                                <p class="mb-2"><strong>Details:</strong> ${error.message}</p>
                                <p class="mb-2"><strong>Possible Causes & Solutions:</strong></p>
                                <ul class="list-disc list-inside space-y-1 ml-4">
                                    <li><strong>File Not Found:</strong> Ensure '${fileName}' is in the same folder as this HTML file. Check for typos.</li>
                                    <li><strong>CORS Issue (Local Problem):</strong> If opening directly (<code>file:///</code> path), use a local web server (e.g., Python's <code>http.server</code> or VS Code Live Server).</li>
                                    <li><strong>Invalid JSON:</strong> The file '${fileName}' might have syntax errors. Validate its content.</li>
                                </ul>
                            </div>
                        </div>
                        <button onclick="loadData(currentJsonFile)" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">Try Again</button>
                    </div>`;
                loadingStateDiv.classList.remove('hidden'); // Ensure error is visible
                document.getElementById('mainContent').classList.add('hidden');
            }
        }

        // Setup charts with proper error handling
        function setupCharts() {
            try {
                console.log('Setting up charts...');
                
                // Destroy existing charts to prevent conflicts
                if (charts.difficulty) {
                    charts.difficulty.destroy();
                }
                if (charts.cognitive) {
                    charts.cognitive.destroy();
                }
                
                // Extract difficulty and cognitive data
                const difficulties = questionsData.map(q => {
                    return q.difficulty_level || q.classification?.difficulty_level || 'Medium';
                });
                
                const cognitive = questionsData.map(q => {
                    return q.blooms_taxonomy || q.classification?.blooms_taxonomy || 'Understand';
                });

                console.log('Difficulties:', difficulties);
                console.log('Cognitive levels:', cognitive);

                // Count occurrences
                const difficultyCount = difficulties.reduce((acc, diff) => {
                    acc[diff] = (acc[diff] || 0) + 1;
                    return acc;
                }, {});

                const cognitiveCount = cognitive.reduce((acc, cog) => {
                    acc[cog] = (acc[cog] || 0) + 1;
                    return acc;
                }, {});

                console.log('Difficulty count:', difficultyCount);
                console.log('Cognitive count:', cognitiveCount);

                // Create doability data based on difficulty
                const easyCount = difficultyCount['Easy'] || 0;
                const mediumCount = difficultyCount['Medium'] || 0;
                const hardCount = difficultyCount['Hard'] || 0;
                
                const doabilityData = {
                    'Highly Doable (Easy)': easyCount,
                    'Moderately Doable (Medium)': Math.floor(mediumCount * 0.7),
                    'Challenging (Medium)': Math.ceil(mediumCount * 0.3),
                    'Very Difficult (Hard)': hardCount
                };

                // Filter out zero values
                const filteredDoability = Object.fromEntries(
                    Object.entries(doabilityData).filter(([key, value]) => value > 0)
                );

                // Difficulty vs Doability Chart (Horizontal Bar)
                const diffCtx = document.getElementById('difficultyChart');
                if (diffCtx && diffCtx.getContext) {
                    try {
                        charts.difficulty = new Chart(diffCtx, {
                            type: 'bar',
                            data: {
                                labels: Object.keys(filteredDoability),
                                datasets: [{
                                    label: 'Number of Questions',
                                    data: Object.values(filteredDoability),
                                    backgroundColor: [
                                        '#10B981', // Green for highly doable
                                        '#F7A621', // Orange for moderately doable
                                        '#EA580C', // Amber for challenging
                                        '#EF4444'  // Red for very difficult
                                    ],
                                    borderWidth: 1,
                                    borderColor: '#fff'
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: true,
                                aspectRatio: 1.2,
                                indexAxis: 'y',
                                plugins: {
                                    legend: {
                                        display: false
                                    },
                                    tooltip: {
                                        callbacks: {
                                            label: function(context) {
                                                const total = Object.values(filteredDoability).reduce((a, b) => a + b, 0);
                                                const percentage = ((context.parsed.x / total) * 100).toFixed(1);
                                                return `${context.parsed.x} questions (${percentage}%)`;
                                            }
                                        }
                                    }
                                },
                                scales: {
                                    x: {
                                        beginAtZero: true,
                                        ticks: {
                                            stepSize: 1,
                                            precision: 0
                                        }
                                    },
                                    y: {
                                        ticks: {
                                            font: {
                                                size: 11
                                            }
                                        }
                                    }
                                },
                                animation: {
                                    duration: 1000
                                }
                            }
                        });
                    } catch (e) {
                        console.error('Error creating difficulty chart:', e);
                    }
                }

                // Cognitive Chart with simplified options
                const cogCtx = document.getElementById('cognitiveChart');
                if (cogCtx && cogCtx.getContext) {
                    try {
                        // Add a small delay to prevent conflicts
                        setTimeout(() => {
                            charts.cognitive = new Chart(cogCtx, {
                                type: 'doughnut',
                                data: {
                                    labels: Object.keys(cognitiveCount),
                                    datasets: [{
                                        data: Object.values(cognitiveCount),
                                        backgroundColor: [
                                            '#45E6C0', // Teal
                                            '#F7A621', // Orange
                                            '#6366F1', // Indigo
                                            '#EC4899', // Pink
                                            '#10B981', // Green
                                            '#F59E0B'  // Amber
                                        ],
                                        borderWidth: 2,
                                        borderColor: '#fff'
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: true,
                                    aspectRatio: 1,
                                    plugins: {
                                        legend: {
                                            position: 'bottom',
                                            labels: {
                                                padding: 15,
                                                usePointStyle: true,
                                                font: {
                                                    size: 11
                                                }
                                            }
                                        },
                                        tooltip: {
                                            callbacks: {
                                                label: function(context) {
                                                    const total = Object.values(cognitiveCount).reduce((a, b) => a + b, 0);
                                                    const percentage = ((context.parsed / total) * 100).toFixed(1);
                                                    return `${context.label}: ${context.parsed} (${percentage}%)`;
                                                }
                                            }
                                        }
                                    },
                                    animation: {
                                        duration: 1000
                                    }
                                }
                            });
                        }, 100);
                    } catch (e) {
                        console.error('Error creating cognitive chart:', e);
                    }
                }

                console.log('Charts setup completed');
            } catch (error) {
                console.error('Error setting up charts:', error);
            }
        }

        // Populate filter dropdowns
        function populateFilters() {
            try {
                const subjects = [...new Set(questionsData.map(q => 
                    q.classification?.subject || 'General'
                ))];

                // Get unique difficulties that actually exist in the data
                const difficulties = [...new Set(questionsData.map(q => 
                    q.difficulty_level || q.classification?.difficulty_level || 'Medium'
                ))];
                
                const subjectFilter = document.getElementById('subjectFilter');
                subjectFilter.innerHTML = '<option value="">All Subjects</option>';
                
                subjects.forEach(subject => {
                    const option = document.createElement('option');
                    option.value = subject;
                    option.textContent = subject;
                    subjectFilter.appendChild(option);
                });

                // Populate difficulty filter with only existing difficulties
                const difficultyFilter = document.getElementById('difficultyFilter');
                difficultyFilter.innerHTML = '<option value="">All Difficulties</option>';
                
                difficulties.forEach(difficulty => {
                    const option = document.createElement('option');
                    option.value = difficulty;
                    option.textContent = difficulty;
                    difficultyFilter.appendChild(option);
                });

                // Add event listeners for filters
                document.getElementById('questionSearch').addEventListener('input', filterQuestions);
                document.getElementById('difficultyFilter').addEventListener('change', filterQuestions);
                document.getElementById('subjectFilter').addEventListener('change', filterQuestions);
                
                console.log('Filters populated');
            } catch (error) {
                console.error('Error populating filters:', error);
            }
        }

        // Filter questions based on search and filters
        function filterQuestions() {
            const searchTerm = document.getElementById('questionSearch').value.toLowerCase();
            const difficultyFilter = document.getElementById('difficultyFilter').value;
            const subjectFilter = document.getElementById('subjectFilter').value;

            filteredQuestions = questionsData.filter(question => {
                const matchesSearch = question.Question.toLowerCase().includes(searchTerm);
                const questionDifficulty = question.difficulty_level || question.classification?.difficulty_level || 'Medium';
                const questionSubject = question.classification?.subject || 'General';
                
                const matchesDifficulty = !difficultyFilter || questionDifficulty === difficultyFilter;
                const matchesSubject = !subjectFilter || questionSubject === subjectFilter;

                return matchesSearch && matchesDifficulty && matchesSubject;
            });

            currentPage = 1;
            renderQuestions();
            setupPagination();
        }

        // Render questions for current page
        function renderQuestions() {
            try {
                const container = document.getElementById('questionsContainer');
                const startIndex = (currentPage - 1) * questionsPerPage;
                const endIndex = startIndex + questionsPerPage;
                const questionsToShow = filteredQuestions.slice(startIndex, endIndex);

                if (questionsToShow.length === 0) {
                    container.innerHTML = '<div class="text-center py-8 text-gray-500">No questions found matching your criteria.</div>';
                    return;
                }

                container.innerHTML = questionsToShow.map(question => createQuestionCard(question)).join('');
                console.log(`Rendered ${questionsToShow.length} questions for page ${currentPage}`);
            } catch (error) {
                console.error('Error rendering questions:', error);
            }
        }

        // Create HTML for a question card
        function createQuestionCard(question) {
            const difficulty = question.classification?.difficulty_level || question.difficulty_level || 'Medium';
            const subject = question.classification?.subject || 'General';
            const difficultyClass = `difficulty-${difficulty.toLowerCase()}`;

            return `
                <div class="question-card ${difficultyClass} bg-white rounded-xl shadow-lg p-6">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center space-x-3">
                            <span class="text-lg font-bold px-3 py-1 rounded-full" style="background: #101E3D; color: white;">Q${question.question_id}</span>
                            <span class="px-3 py-1 rounded-full text-sm font-medium" style="background: rgba(247, 166, 33, 0.1); color: #F7A621;">${subject}</span>
                            <span class="px-3 py-1 rounded-full text-sm font-medium difficulty-badge-${difficulty.toLowerCase()}">${difficulty}</span>
                        </div>
                        <button onclick="toggleQuestionDetails(${question.question_id})" class="text-blue-600 hover:text-blue-800 font-medium">
                            <span id="toggle-text-${question.question_id}">View Analysis</span>
                            <svg id="toggle-icon-${question.question_id}" class="w-4 h-4 inline ml-1 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                        </button>
                    </div>

                    <div class="mb-4">
                        <p class="text-gray-800 leading-relaxed">${question.Question}</p>
                    </div>

                    <div class="grid md:grid-cols-2 gap-3 mb-4">
                        ${Object.entries(question.options).map(([key, value]) => `
                            <div class="flex items-center space-x-3 p-3 rounded-lg border ${question.correct_answer === key ? 'bg-green-50 border-green-200' : 'bg-gray-50 border-gray-200'}">
                                <span class="option-letter ${question.correct_answer === key ? 'correct-option' : ''}">${key.toUpperCase()}</span>
                                <span class="text-gray-800">${value}</span>
                            </div>
                        `).join('')}
                    </div>

                    <div id="details-${question.question_id}" class="dropdown-content">
                        <div class="border-t pt-6 space-y-6">
                            <!-- Solution -->
                            <div>
                                <h4 class="font-bold text-lg mb-3" style="color: #101E3D;">Detailed Solution</h4>
                                <p class="text-gray-700 leading-relaxed">${question.solution || 'Solution not available'}</p>
                            </div>

                            <!-- Step by Step -->
                            ${question.step_by_step && question.step_by_step.length > 0 ? `
                                <div>
                                    <h4 class="font-bold text-lg mb-3" style="color: #101E3D;">Step-by-Step Approach</h4>
                                    <div class="space-y-2">
                                        ${question.step_by_step.map(step => `
                                            <div class="step-item p-3 rounded-lg">
                                                <p class="text-gray-700">${step}</p>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}

                            <!-- Tips and Tricks -->
                            ${question.tips_and_tricks && question.tips_and_tricks.length > 0 ? `
                                <div>
                                    <h4 class="font-bold text-lg mb-3" style="color: #101E3D;">Tips & Tricks</h4>
                                    <div class="space-y-2">
                                        ${question.tips_and_tricks.map(tip => `
                                            <div class="tip-item p-3 rounded-lg">
                                                <p class="text-gray-700">${tip}</p>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}

                            <!-- Classification -->
                            ${question.classification ? `
                                <div>
                                    <h4 class="font-bold text-lg mb-3" style="color: #101E3D;">Question Classification</h4>
                                    <div class="grid md:grid-cols-2 gap-4">
                                        <div class="space-y-2">
                                            <p><strong>Subject:</strong> ${question.classification.subject || 'N/A'}</p>
                                            <p><strong>Topic:</strong> ${question.classification.topic || 'N/A'}</p>
                                            <p><strong>Subtopic:</strong> ${question.classification.subtopic || 'N/A'}</p>
                                        </div>
                                        <div class="space-y-2">
                                            <p><strong>Difficulty:</strong> ${question.difficulty_level || question.classification.difficulty_level || 'N/A'}</p>
                                            <p><strong>Bloom's Level:</strong> ${question.blooms_taxonomy || question.classification.blooms_taxonomy || 'N/A'}</p>
                                            <p><strong>Concept:</strong> ${question.classification.concept || 'N/A'}</p>
                                        </div>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        // Toggle question details
        function toggleQuestionDetails(questionId) {
            const details = document.getElementById(`details-${questionId}`);
            const toggleText = document.getElementById(`toggle-text-${questionId}`);
            const toggleIcon = document.getElementById(`toggle-icon-${questionId}`);
            
            const isCurrentlyExpanded = details.classList.contains('expanded');
            
            // Close all other expanded details first
            document.querySelectorAll('.dropdown-content.expanded').forEach(expandedDetail => {
                if (expandedDetail.id !== `details-${questionId}`) {
                    expandedDetail.classList.remove('expanded');
                    
                    // Update the toggle text and icon for the closed ones
                    const detailId = expandedDetail.id.replace('details-', '');
                    const otherToggleText = document.getElementById(`toggle-text-${detailId}`);
                    const otherToggleIcon = document.getElementById(`toggle-icon-${detailId}`);
                    
                    if (otherToggleText) otherToggleText.textContent = 'View Analysis';
                    if (otherToggleIcon) otherToggleIcon.style.transform = 'rotate(0deg)';
                }
            });
            
            // Now toggle the current one
            if (isCurrentlyExpanded) {
                details.classList.remove('expanded');
                toggleText.textContent = 'View Analysis';
                toggleIcon.style.transform = 'rotate(0deg)';
            } else {
                details.classList.add('expanded');
                toggleText.textContent = 'Hide Analysis';
                toggleIcon.style.transform = 'rotate(180deg)';
            }
        }

        // Setup pagination
        function setupPagination() {
            const totalPages = Math.ceil(filteredQuestions.length / questionsPerPage);
            const pagination = document.getElementById('pagination');
            
            pagination.innerHTML = '';

            if (totalPages <= 1) return;

            for (let i = 1; i <= totalPages; i++) {
                const button = document.createElement('button');
                button.textContent = i;
                button.className = `px-4 py-2 rounded-lg transition-colors ${i === currentPage ? 'bg-blue-600 text-white' : 'bg-white text-gray-700 hover:bg-gray-100'}`;
                button.onclick = () => {
                    currentPage = i;
                    renderQuestions();
                    setupPagination();
                    document.getElementById('questions-section').scrollIntoView({ behavior: 'smooth' });
                };
                pagination.appendChild(button);
            }
        }

        // Update statistics based on loaded data
        function updateStatistics() {
            try {
                const difficulties = questionsData.map(q => 
                    q.classification?.difficulty_level || q.difficulty_level || 'Medium'
                );
                
                const easyCount = difficulties.filter(d => d === 'Easy').length;
                const mediumCount = difficulties.filter(d => d === 'Medium').length;
                const hardCount = difficulties.filter(d => d === 'Hard').length;
                const totalQuestions = questionsData.length;
                
                // Update doable questions count
                const doableMin = easyCount + Math.floor(mediumCount * 0.6);
                const doableMax = easyCount + Math.floor(mediumCount * 0.8);
                document.getElementById('doableQuestions').textContent = `${doableMin}-${doableMax}`;
                
                // Update average difficulty
                const avgDifficultyElement = document.getElementById('avgDifficulty');
                if (hardCount > totalQuestions * 0.4) {
                    avgDifficultyElement.textContent = 'Hard';
                } else if (easyCount > totalQuestions * 0.4) {
                    avgDifficultyElement.textContent = 'Easy';
                } else {
                    avgDifficultyElement.textContent = 'Medium';
                }
                
                console.log('Statistics updated');
            } catch (error) {
                console.error('Error updating statistics:', error);
            }
        }
    </script>
</body>
</html>